import{j as y}from"./emotion-react-jsx-runtime.browser.esm-B6nDGTOp.js";import{i as E}from"./inspectMessage-DlwZE6zu.js";import{r as N}from"./random-CmfFXdz5.js";import{d as w}from"./delay-CaiE5JvH.js";import{d as v}from"./disableControl-BnIAncyP.js";import{r as h}from"./index-qCb0-TeD.js";import{e as b}from"./index-XhuPYLZg.js";import{d as q}from"./dummy-D_FwLovb.js";import{S as A,n as g,d as x,r as H,a as I,b as B}from"./useMutation-BNzakrCb.js";import{Q as T,u as j,a as K,e as L,b as _,c as P,s as S,f as C,w as U,g as $}from"./suspense-lUpQ7myJ.js";import{s as R}from"./index-FhjP52Um.js";import"./jsx-runtime-DzlC0hKS.js";import"./index-BAiONZ7V.js";import"./emotion-react.browser.esm-DKbCFQzN.js";import"./index-BA0eH0Wu.js";import"./define-D3i8B5cg.js";import"./types-Dn-G_zsM.js";import"./traditional-B_ldJKp3.js";import"./index-CrYrvawI.js";import"./index-C5U6HIMD.js";import"./index-DzgdUzM0.js";import"./index-iJUMMFGI.js";import"./index-MOlr3Ojg.js";import"./index-BsfIDxJ3.js";import"./index-CatqC4ig.js";import"./property-DTA7hnOA.js";import"./get-DGJ4vF0c.js";import"./vanilla-DtBHub2h.js";import"./capitalize-CY0R7VOI.js";import"./omit-LJmhX_jk.js";import"./presets-fZzeZ6Sn.js";import"./DisabledContext-NEMnJEZA.js";import"./index-DbGQkxQ5.js";import"./index-fivQpuRm.js";import"./index-CmoHrzZA.js";import"./index-BgnjLMVA.js";import"./emotion-styled-base.browser.esm-DcS0-Etw.js";import"./memo-BZYTsoqr.js";import"./assignDisplayName-lT0r0-ot.js";import"./getDisplayName-Cdt1H-sM.js";import"./Empty-Wvpx-ZQe.js";import"./BarLoading-Rkd_MQ9I.js";import"./index-gEP6Tn1u.js";import"./index-_xFncG76.js";import"./index-C5sRnb5L.js";import"./useIsTouchOnlyLikeDeviceStore-ChrBTq0u.js";import"./react-CzPQQEyf.js";import"./flow-Caod8tMH.js";import"./flow-DLnCjMlr.js";import"./uniq-BL7hiWVS.js";import"./isArrayLike-CCcVsAV0.js";import"./index-CiDJ99qe.js";import"./index-NCLGaooH.js";import"./Portal-qV56MC8h.js";import"./toConsumableArray-BjwuTSou.js";import"./useSize-XLj32eBt.js";import"./shadow-smhd3i8u.js";import"./useId-CkKFPa5_.js";import"./isVisible-DhUEo0yb.js";import"./ContextIsolator-CdD3uTNK.js";import"./context-bgT8s9yI.js";import"./asyncToGenerator-CUe5B5qN.js";import"./Compact-VphdgA5n.js";import"./useZIndex-BbbELKB6.js";import"./motion-DdkSFxyu.js";import"./reactNode-CVIZC-dj.js";import"./colors-wf8q_7Rm.js";import"./presetColors-DLnX3ho6.js";import"./useHandler-HI23tEoY.js";import"./useEventCallback-HuInTmxh.js";import"./index-Ctp16WHO.js";import"./message-DDWR6R3O.js";import"./NarrowIconButton-CPJBcQ2f.js";import"./index-DIYPjkqE.js";import"./env-B2Oq9Sof.js";import"./StringToNumberSchema-DICqxOFk.js";import"./index-BQ-NB-n4.js";import"./appConstant-DrkG7OWi.js";import"./index-8L6fjrd-.js";import"./debounce-DBoK0mBS.js";import"./omitBy-DH6X2eoo.js";import"./index-Bf2qc8Rt.js";import"./sentry-DXsovuw2.js";import"./tags-CpduBB1M.js";import"./noop-DX6rZLP_.js";import"./shouldProcessLinkClick-Cauo1FQC.js";import"./pathe.ff20891b-CZu1kPQR.js";import"./button-B7-d1yET.js";import"./index-BZsVY9hW.js";import"./LoadingOutlined-PTw75qLp.js";import"./AntdIcon-C0KfWvva.js";import"./compact-item-5orumCwJ.js";import"./index-DN361_u3.js";import"./InfoCircleFilled-0VRkendn.js";import"./CloseCircleFilled-Bgzza4Eo.js";import"./KeyCode-lh1qUinJ.js";import"./pickAttrs-XdSaTJtx.js";import"./useCSSVarCls-DCHdCyfl.js";import"./CloseOutlined-CfOpPp0C.js";import"./index-Ds41-CWB.js";import"./models-D08OMJcb.js";import"./literalUnion-DyVqFjOM.js";import"./Iso4217CurrencySchema-I5Px3Rsp.js";import"./WeekdayNumberSchema-CgxigkyA.js";import"./index-CK730dNH.js";import"./index-CmqFZ15x.js";import"./pick-DYnZlk75.js";import"./Trans-B7RBgX3a.js";import"./useTranslation-XVYQH2mr.js";import"./index-CVRwA_xR.js";import"./index-C4jkG3Yz.js";import"./index-ADXJD4hY.js";import"./safeString-CSiFDyUi.js";import"./TextArea-vizGfyJg.js";import"./useVariants-CK8wnbnE.js";import"./CopyButton-CSca9IhR.js";import"./index-D0v7HZQV.js";import"./CheckOutlined-DcewmLkY.js";import"./index-CXnOxbGU.js";import"./SearchOutlined-CS-6PfVh.js";import"./merge-BUZDYRsv.js";import"./cloneDeepWith-ktajmmvU.js";import"./isPrimitive-CtkJ6J5I.js";import"./isArguments-DZsL9lab.js";import"./isTypedArray-CzKvdEgb.js";import"./omit-C4DMN5cy.js";import"./Table-BhK3Wfjf.js";import"./styleChecker-BQsV-VhF.js";import"./DownOutlined-C-IxbET4.js";import"./index-BzlLN0ST.js";import"./List-BcMJ_vkB.js";import"./index-BL1rL1qh.js";import"./collapse-BbEVqHco.js";import"./index-p5sF-HGJ.js";import"./useBubbleLock-OqGqq4Qb.js";import"./dropdown-C3EYHk1w.js";import"./RightOutlined-DQ8lOCUC.js";import"./Dropdown-Bwcoigng.js";import"./PurePanel-Bml8ml_A.js";import"./index-CxjtMtYp.js";import"./EllipsisOutlined-DrjggAzd.js";import"./Overflow-DF_X_I1g.js";import"./index-CogmkLD2.js";import"./index-BVhqM5T_.js";import"./useLocale-D6ZQsxC3.js";import"./useBreakpoint-CVOk84jo.js";class F extends A{constructor(e,m){super(),this.client=e,this.queries=[],this.result=[],this.observers=[],this.observersMap={},m&&this.setQueries(m)}onSubscribe(){this.listeners.size===1&&this.observers.forEach(e=>{e.subscribe(m=>{this.onUpdate(e,m)})})}onUnsubscribe(){this.listeners.size||this.destroy()}destroy(){this.listeners=new Set,this.observers.forEach(e=>{e.destroy()})}setQueries(e,m){this.queries=e,g.batch(()=>{const p=this.observers,c=this.findMatchingObservers(this.queries);c.forEach(t=>t.observer.setOptions(t.defaultedQueryOptions,m));const a=c.map(t=>t.observer),l=Object.fromEntries(a.map(t=>[t.options.queryHash,t])),f=a.map(t=>t.getCurrentResult()),O=a.some((t,n)=>t!==p[n]);p.length===a.length&&!O||(this.observers=a,this.observersMap=l,this.result=f,this.hasListeners()&&(x(p,a).forEach(t=>{t.destroy()}),x(a,p).forEach(t=>{t.subscribe(n=>{this.onUpdate(t,n)})}),this.notify()))})}getCurrentResult(){return this.result}getQueries(){return this.observers.map(e=>e.getCurrentQuery())}getObservers(){return this.observers}getOptimisticResult(e){return this.findMatchingObservers(e).map(m=>m.observer.getOptimisticResult(m.defaultedQueryOptions))}findMatchingObservers(e){const m=this.observers,p=new Map(m.map(r=>[r.options.queryHash,r])),c=e.map(r=>this.client.defaultQueryOptions(r)),a=c.flatMap(r=>{const o=p.get(r.queryHash);return o!=null?[{defaultedQueryOptions:r,observer:o}]:[]}),l=new Set(a.map(r=>r.defaultedQueryOptions.queryHash)),f=c.filter(r=>!l.has(r.queryHash)),O=new Set(a.map(r=>r.observer)),t=m.filter(r=>!O.has(r)),n=r=>{const o=this.client.defaultQueryOptions(r),u=this.observersMap[o.queryHash];return u??new T(this.client,o)},s=f.map((r,o)=>{if(r.keepPreviousData){const u=t[o];if(u!==void 0)return{defaultedQueryOptions:r,observer:u}}return{defaultedQueryOptions:r,observer:n(r)}}),i=(r,o)=>c.indexOf(r.defaultedQueryOptions)-c.indexOf(o.defaultedQueryOptions);return a.concat(s).sort(i)}onUpdate(e,m){const p=this.observers.indexOf(e);p!==-1&&(this.result=H(this.result,p,m),this.notify())}notify(){g.batch(()=>{this.listeners.forEach(({listener:e})=>{e(this.result)})})}}function z({queries:d,context:e}){const m=I({context:e}),p=j(),c=K(),a=h.useMemo(()=>d.map(i=>{const r=m.defaultQueryOptions(i);return r._optimisticResults=p?"isRestoring":"optimistic",r}),[d,m,p]);a.forEach(i=>{L(i),_(i,c)}),P(c);const[l]=h.useState(()=>new F(m,a)),f=l.getOptimisticResult(a);B(h.useCallback(i=>p?()=>{}:l.subscribe(g.batchCalls(i)),[l,p]),()=>l.getCurrentResult(),()=>l.getCurrentResult()),h.useEffect(()=>{l.setQueries(a,{listeners:!1})},[a,l]);const t=f.some((i,r)=>S(a[r],i,p))?f.flatMap((i,r)=>{const o=a[r],u=l.getObservers()[r];if(o&&u){if(S(o,i,p))return C(o,u,c);U(i,p)&&C(o,u,c)}return[]}):[];if(t.length>0)throw Promise.all(t);const n=l.getQueries(),s=f.find((i,r)=>{var o,u;return $({result:i,errorResetBoundary:c,useErrorBoundary:(o=(u=a[r])==null?void 0:u.useErrorBoundary)!=null?o:!1,query:n[r]})});if(s!=null&&s.error)throw s.error;return f}const D=N(),W=[],G=q.map((d,e)=>({...d,key:e+1,...e%2===0?null:{children:W}})),J=b,V=[{title:"#",dataIndex:"key",key:"key",fixed:"left"},{title:"Name",children:[{title:"First Name",dataIndex:"firstName",key:"firstName",defaultSortOrder:"ascend",sorter:(d,e)=>d.firstName.localeCompare(e.firstName)},{title:"Last Name",dataIndex:"lastName",key:"lastName",sorter:(d,e)=>d.lastName.localeCompare(e.lastName)}]},{title:"Age",dataIndex:"age",key:"age",sorter:(d,e)=>d.age-e.age},{title:"Address",dataIndex:"address",key:"address",sorter:(d,e)=>d.address.localeCompare(e.address)}],X=h.forwardRef(function(e,m){const[p,c]=h.useState([]),a=I(),l=h.useCallback(function(n){return[{[`fakeChildren-${D}`]:n}]},[]),f=z({queries:p.map(t=>({queryKey:l(t),async queryFn({signal:s}){if(t%4===0)throw await w(R(1),s),s==null||s.throwIfAborted(),new Error("Failed to load children");return await w(R(3),s),s==null||s.throwIfAborted(),Array.from({length:5}).flatMap((o,u)=>{const Q=q[t];if(!Q)return[];const k=(u+1)*1e3+t;return[{...Q,key:k}]})},retry:!1}))}),O=h.useMemo(()=>{var t;return(t=e.dataSource)==null?void 0:t.map(n=>{const s=n.id,i=(()=>{const r=p.indexOf(s);if(r===-1)return null;const o=f[r];return!o||!o.isSuccess?null:o.data})();return i?{...n,children:i}:n})},[p,e.dataSource,f]);return y(b,{...e,dataSource:O,ref:m,expandable:{expandIcon({expanded:t,onExpand:n,record:s,expandable:i}){if(i&&t){const r=p.indexOf(s.id);if(r===-1){const u=new Error(E`Index not found. record: ${s}`);return y(b.ExpandError,{error:u,onExpand:n,record:s})}const o=f[r];if(!o){const u=new Error(E`Query not found. record: ${s}`);return y(b.ExpandError,{error:u,onExpand:n,record:s})}if(o.isError)return y(b.ExpandError,{error:o.error,onExpand:(...u)=>{a.removeQueries(l(s.id)),n(...u)},record:s});if(o.isLoading)return y(b.ExpandLoading,{onExpand:n,record:s})}return y(b.ExpandIcon,{expandable:i,expanded:t,onExpand:n,record:s})},onExpand:(t,n)=>{if(t){c(s=>[...s,n.id]);return}c(s=>s.filter(i=>i!==n.id))}}})}),M=[5,10,20,50,100],Tt={component:J,args:{search:"",dataSource:G,columns:V},argTypes:{paginationPageSize:{control:{type:"inline-radio"},options:M,mapping:Object.fromEntries(M.map(d=>[d,d]))},dataSource:v,columns:v,ref:v,locale:v},render({...d}){return y(X,{...d})}},jt={},Kt=["AsyncChildren"];export{jt as AsyncChildren,Kt as __namedExportsOrder,Tt as default};
