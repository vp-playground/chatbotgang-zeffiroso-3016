import{j as x,a as Ge,F as He}from"./emotion-react-jsx-runtime.browser.esm-B6nDGTOp.js";import{c as W}from"./emotion-react.browser.esm-DKbCFQzN.js";import{t as ce}from"./index-BA0eH0Wu.js";import{b as We,l as ye}from"./omit-LJmhX_jk.js";import{r as m}from"./index-qCb0-TeD.js";import{E as Be}from"./index-BgnjLMVA.js";import{B as fe}from"./BarLoading-Rkd_MQ9I.js";import{a as le}from"./assignDisplayName-lT0r0-ot.js";import{c as ue}from"./index-DbGQkxQ5.js";import{i as Re}from"./inspectMessage-DlwZE6zu.js";import{M as Se}from"./index-_xFncG76.js";import{T as Ye}from"./index-C5sRnb5L.js";import{u as Z}from"./useHandler-HI23tEoY.js";import{A as xe,C as Xe}from"./index-Ctp16WHO.js";import{u as Qe}from"./message-DDWR6R3O.js";import{E as ze}from"./index-Ds41-CWB.js";import{l as qe,i as q}from"./sentry-DXsovuw2.js";import{E as Je}from"./models-D08OMJcb.js";import{T as Ze}from"./Trans-B7RBgX3a.js";import{d as Q,b as et}from"./index-gEP6Tn1u.js";import{R as tt}from"./LoadingOutlined-PTw75qLp.js";import{r as Ne}from"./random-CmfFXdz5.js";import{u as rt}from"./index-CVRwA_xR.js";import{I as nt}from"./index-ADXJD4hY.js";import{u as Ie}from"./useTranslation-XVYQH2mr.js";import{d as st}from"./debounce-DBoK0mBS.js";import{s as ot}from"./index-FhjP52Um.js";import{o as it}from"./omit-C4DMN5cy.js";import{f as at}from"./flow-Caod8tMH.js";import{m as Ae}from"./merge-BUZDYRsv.js";import{F as ct}from"./Table-BhK3Wfjf.js";function he(){const t=m.useContext(We);if(!t)throw new Error(Re`configContext is falsy: ${t}`);return t}const lt=new ze,ut=300,be=(...t)=>{const[e,r]=t,n=(...o)=>x(Ze,{i18nKey:e,...r?{values:r}:null,...o});return{args:t,key:e,options:r,node:x(n,{}),Component:n}},Oe={code:0,name:Symbol("NetworkError")},g=be,$={[Oe.name]:g("common.apiError.networkError"),PARAMETER_INVALID:g("common.apiError.invalidRequestParameter"),PARAMETER_EMAIL_OR_PASSWORD_INVALID:null,PARAMETER_USER_EXIST:null,AUTH_NOT_AUTHENTICATED:g("common.apiError.unauthorized"),PARAMETER_WEAK_PASSWORD:null,PAYMENT_EXPIRED_PLAN:g("common.apiError.paymentRequest"),PAYMENT_NO_ENOUGH_SEAT:g("common.apiError.paymentRequest"),AUTH_PERMISSION_DENIED:g("common.apiError.permissionDenied"),AUTH_UNAUTHORIZED_ORG:g("common.apiError.permissionDenied"),RESOURCE_NOT_FOUND:g("common.apiError.resourceNotFound"),INTERNAL_PROCESS:g("common.apiError.serverError"),REMOTE_PROCESS_ERROR:g("common.apiError.serverError"),REMOTE_LINE_CLIENT_ERROR:g("common.apiError.serverError"),REMOTE_LINE_REACH_BUDGET_LIMIT:g("chat.error.reachMonthlyLimit"),UNKNOWN_ERROR:g("common.applicationError.unknownError"),QUICK_TEMPLATE_CATEGORY_ALREADY_EXISTED:null,QUICK_TEMPLATE_CATEGORY_OVER_QUANTITY_LIMIT:null,QUICK_TEMPLATE_CONTAIN_TOO_MANY_MESSAGES:g("quickTemplate.containTooManyMessages"),QUICK_TEMPLATE_NAME_ALREADY_EXISTED:g("quickTemplate.nameAlreadyExisted"),QUICK_TEMPLATE_OVER_QUANTITY_LIMIT:null,BULK_QUICK_TEMPLATE_ERROR_PARSE_FAIL:null,QUICK_TEMPLATE_OVER_ROWS_LIMIT:null,TOO_MANY_REQUESTS:g("common.apiError.reachLimitTryLater"),AUTO_ASSIGNMENT_RULE_ASSIGNEE_AN_AGENT_EXISTED:null,AUTO_ASSIGNMENT_RULE_ASSIGNEE_A_TEAM_EXISTED:g("team.listPage.deleteTeam.failed"),AUTO_ASSIGNMENT_RULE_NAME_ALREADY_EXISTED:g("assignment.autoAssignmentRule.edit.error.nameConflict"),REMOTE_OPENAI_CLIENT_ERROR:g("chat.aiCompletion.error.remoteOpenAiClientError"),SEND_MESSAGE_MEMBER_OUT_OF_YOUR_SCOPE:null,REMOTE_CDH_PROFILE_NOT_FOUND:null,REMOTE_LINE_RESOURCE_NOT_FOUND:null,CHANNEL_BELONG_TO_ANOTHER_ORG:null,AUTH_OTP_MISMATCH:null,AUTH_OTP_MAX_ATTEMPTS_EXCEEDED:null,AUTH_OTP_EXPIRED:null,FB_TOKEN_EXPIRE:g("chat.error.fbTokenExpired"),REMOTE_LINE_NG_SENDER_NAME:g("chat.error.lineNgSenderName"),BULK_INVITE_USER_ERROR_PARSE_FAIL:null,BULK_INVITE_USER_ERROR_EXCEED_ROW_LIMIT:null,BULK_INVITE_USER_ERROR_INSUFFICIENT_SEAT:null,BULK_INVITE_USER_ERROR_INVALID_CONTENT:null,AUTO_ASSIGNMENT_RULE_NUMBER_EXCEED:g("assignment.routingRules.overQuantityLimit",{count:ut}),BOT_NOT_FOUND:null};Object.entries($).flatMap(([t,e])=>e===null?[t]:[]);function Ce(t){var e;if(t instanceof xe){if(t.code==="ERR_NETWORK")return Oe;const r=Je.safeParse((e=t.response)==null?void 0:e.data);if(r.success)return r.data}return null}const ht=be;function ee(t){if(t instanceof Xe)return null;const e=Ce(t);return e?(lt.emit("knownError",e),$[e.name]??null):(qe(t),ht("common.applicationError.unknownError"))}function B(){return m.useCallback(function(r,n){const s=Ce(r),o=(s&&(s==null?void 0:s.name)!=="UNKNOWN_ERROR"?$[s.name]:$.UNKNOWN_ERROR)??$.UNKNOWN_ERROR,i=o===$.UNKNOWN_ERROR?(n==null?void 0:n.unknownErrorMessage)??$.UNKNOWN_ERROR.node:o.node;return i&&Ge(He,{children:[i,o!==$.UNKNOWN_ERROR?null:`: ${r instanceof Error?`[${r.name}]: ${r.message}`:Re`Non-error object thrown: ${r}`}`]})},[])}function pe(){const t=Qe(),e=B();return Z(function(s){if(!ee(s))return;const i=(()=>{if(!(s instanceof xe))return!1;const a=s.response;return a?a.status>=400&&a.status<500:!1})();t[i?"warning":"error"](e(s))})}try{ee.displayName="handleError",ee.__docgenInfo={description:"Handles application errors or logs them to Sentry. It will return a\ntranslation key by different types of error. If the error is not an exact\nerror, or we don't want to handle it globally, it will return `null`.",displayName:"handleError",props:{}}}catch{}try{B.displayName="useGetErrorMessage",B.__docgenInfo={description:`Hook to get error message from any error including cancellation error and
non-global error.`,displayName:"useGetErrorMessage",props:{}}}catch{}try{pe.displayName="useHandleErrorAndShowMessage",pe.__docgenInfo={description:"Shorthand for handling errors and showing error message.",displayName:"useHandleErrorAndShowMessage",props:{}}}catch{}const dt=Q({ExpandError:W({borderColor:"transparent",color:ce.colors.error,"&:before,&:after":{content:"none"}},";label:emotion-ExpandError;")}),Le=m.forwardRef(function({prefixCls:e,locale:r,onExpand:n,record:s,error:o,...i},a){const c=he(),{getPrefixCls:l,locale:u=X.defaultLocale}=c,d=`${l("table",e)}-row-expand-icon`,p=m.useMemo(()=>({...u.Table,...r}),[u.Table,r]),E=B(),_=m.useMemo(()=>E(o),[o,E]);return x(Ye,{title:_,children:x("button",{type:"button",onClick:I=>{n(s,I),I.stopPropagation()},css:dt.ExpandError,className:ue(d,`${d}-expanded`),"aria-label":p.collapse,"aria-expanded":!0,ref:a,...i,children:x(Se,{"un-i-motif":"warning"})})})});le(Le,"Table.ExpandError");const we=m.forwardRef(function({prefixCls:e,locale:r,onExpand:n,record:s,expanded:o,expandable:i,...a},c){const l=he(),{getPrefixCls:u,locale:h=ye}=l,p=`${u("table",e)}-row-expand-icon`,E=m.useMemo(()=>({...h.Table,...r}),[h.Table,r]);return x("button",{type:"button",onClick:_=>{n(s,_),_.stopPropagation()},className:ue(p,{[`${p}-spaced`]:!i,[`${p}-expanded`]:i&&o,[`${p}-collapsed`]:i&&!o}),"aria-label":o?E.collapse:E.expand,"aria-expanded":o,ref:c,...a})});le(we,"Table.ExpandIcon");const ft=Q({expandLoading:{name:"pn3r7r-emotion-expandLoading",styles:"border-color:transparent;&:before,&:after{content:none;};label:emotion-expandLoading;"}}),Ue=m.forwardRef(function({prefixCls:e,locale:r,onExpand:n,record:s,...o},i){const a=he(),{getPrefixCls:c,locale:l=X.defaultLocale}=a,h=`${c("table",e)}-row-expand-icon`,d=m.useMemo(()=>({...l.Table,...r}),[l.Table,r]);return x("button",{type:"button",onClick:p=>{n(s,p),p.stopPropagation()},css:ft.expandLoading,className:ue(h,`${h}-expanded`),"aria-label":d.collapse,"aria-expanded":!0,ref:i,...o,children:x(tt,{})})});le(Ue,"Table.ExpandLoading");function U(t){return Array.isArray?Array.isArray(t):$e(t)==="[object Array]"}function pt(t){if(typeof t=="string")return t;let e=t+"";return e=="0"&&1/t==-1/0?"-0":e}function mt(t){return t==null?"":pt(t)}function L(t){return typeof t=="string"}function ke(t){return typeof t=="number"}function Et(t){return t===!0||t===!1||gt(t)&&$e(t)=="[object Boolean]"}function Pe(t){return typeof t=="object"}function gt(t){return Pe(t)&&t!==null}function N(t){return t!=null}function J(t){return!t.trim().length}function $e(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}const _t="Incorrect 'index' type",Mt=t=>`Invalid value for key ${t}`,Tt=t=>`Pattern length exceeds max of ${t}.`,yt=t=>`Missing ${t} property in key`,Rt=t=>`Property 'weight' in key '${t}' must be a positive integer`,me=Object.prototype.hasOwnProperty;class St{constructor(e){this._keys=[],this._keyMap={};let r=0;e.forEach(n=>{let s=Fe(n);this._keys.push(s),this._keyMap[s.id]=s,r+=s.weight}),this._keys.forEach(n=>{n.weight/=r})}get(e){return this._keyMap[e]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function Fe(t){let e=null,r=null,n=null,s=1,o=null;if(L(t)||U(t))n=t,e=Ee(t),r=te(t);else{if(!me.call(t,"name"))throw new Error(yt("name"));const i=t.name;if(n=i,me.call(t,"weight")&&(s=t.weight,s<=0))throw new Error(Rt(i));e=Ee(i),r=te(i),o=t.getFn}return{path:e,id:r,weight:s,src:n,getFn:o}}function Ee(t){return U(t)?t:t.split(".")}function te(t){return U(t)?t.join("."):t}function xt(t,e){let r=[],n=!1;const s=(o,i,a)=>{if(N(o))if(!i[a])r.push(o);else{let c=i[a];const l=o[c];if(!N(l))return;if(a===i.length-1&&(L(l)||ke(l)||Et(l)))r.push(mt(l));else if(U(l)){n=!0;for(let u=0,h=l.length;u<h;u+=1)s(l[u],i,a+1)}else i.length&&s(l,i,a+1)}};return s(t,L(e)?e.split("."):e,0),n?r:r[0]}const Nt={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},It={isCaseSensitive:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(t,e)=>t.score===e.score?t.idx<e.idx?-1:1:t.score<e.score?-1:1},At={location:0,threshold:.6,distance:100},bt={useExtendedSearch:!1,getFn:xt,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1};var f={...It,...Nt,...At,...bt};const Ot=/[^ ]+/g;function Ct(t=1,e=3){const r=new Map,n=Math.pow(10,e);return{get(s){const o=s.match(Ot).length;if(r.has(o))return r.get(o);const i=1/Math.pow(o,.5*t),a=parseFloat(Math.round(i*n)/n);return r.set(o,a),a},clear(){r.clear()}}}class de{constructor({getFn:e=f.getFn,fieldNormWeight:r=f.fieldNormWeight}={}){this.norm=Ct(r,3),this.getFn=e,this.isCreated=!1,this.setIndexRecords()}setSources(e=[]){this.docs=e}setIndexRecords(e=[]){this.records=e}setKeys(e=[]){this.keys=e,this._keysMap={},e.forEach((r,n)=>{this._keysMap[r.id]=n})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,L(this.docs[0])?this.docs.forEach((e,r)=>{this._addString(e,r)}):this.docs.forEach((e,r)=>{this._addObject(e,r)}),this.norm.clear())}add(e){const r=this.size();L(e)?this._addString(e,r):this._addObject(e,r)}removeAt(e){this.records.splice(e,1);for(let r=e,n=this.size();r<n;r+=1)this.records[r].i-=1}getValueForItemAtKeyId(e,r){return e[this._keysMap[r]]}size(){return this.records.length}_addString(e,r){if(!N(e)||J(e))return;let n={v:e,i:r,n:this.norm.get(e)};this.records.push(n)}_addObject(e,r){let n={i:r,$:{}};this.keys.forEach((s,o)=>{let i=s.getFn?s.getFn(e):this.getFn(e,s.path);if(N(i)){if(U(i)){let a=[];const c=[{nestedArrIndex:-1,value:i}];for(;c.length;){const{nestedArrIndex:l,value:u}=c.pop();if(N(u))if(L(u)&&!J(u)){let h={v:u,i:l,n:this.norm.get(u)};a.push(h)}else U(u)&&u.forEach((h,d)=>{c.push({nestedArrIndex:d,value:h})})}n.$[o]=a}else if(L(i)&&!J(i)){let a={v:i,n:this.norm.get(i)};n.$[o]=a}}}),this.records.push(n)}toJSON(){return{keys:this.keys,records:this.records}}}function ve(t,e,{getFn:r=f.getFn,fieldNormWeight:n=f.fieldNormWeight}={}){const s=new de({getFn:r,fieldNormWeight:n});return s.setKeys(t.map(Fe)),s.setSources(e),s.create(),s}function Lt(t,{getFn:e=f.getFn,fieldNormWeight:r=f.fieldNormWeight}={}){const{keys:n,records:s}=t,o=new de({getFn:e,fieldNormWeight:r});return o.setKeys(n),o.setIndexRecords(s),o}function G(t,{errors:e=0,currentLocation:r=0,expectedLocation:n=0,distance:s=f.distance,ignoreLocation:o=f.ignoreLocation}={}){const i=e/t.length;if(o)return i;const a=Math.abs(n-r);return s?i+a/s:a?1:i}function wt(t=[],e=f.minMatchCharLength){let r=[],n=-1,s=-1,o=0;for(let i=t.length;o<i;o+=1){let a=t[o];a&&n===-1?n=o:!a&&n!==-1&&(s=o-1,s-n+1>=e&&r.push([n,s]),n=-1)}return t[o-1]&&o-n>=e&&r.push([n,o-1]),r}const v=32;function Ut(t,e,r,{location:n=f.location,distance:s=f.distance,threshold:o=f.threshold,findAllMatches:i=f.findAllMatches,minMatchCharLength:a=f.minMatchCharLength,includeMatches:c=f.includeMatches,ignoreLocation:l=f.ignoreLocation}={}){if(e.length>v)throw new Error(Tt(v));const u=e.length,h=t.length,d=Math.max(0,Math.min(n,h));let p=o,E=d;const _=a>1||c,I=_?Array(h):[];let A;for(;(A=t.indexOf(e,E))>-1;){let R=G(e,{currentLocation:A,expectedLocation:d,distance:s,ignoreLocation:l});if(p=Math.min(R,p),E=A+u,_){let O=0;for(;O<u;)I[A+O]=1,O+=1}}E=-1;let w=[],b=1,y=u+h;const V=1<<u-1;for(let R=0;R<u;R+=1){let O=0,C=y;for(;O<C;)G(e,{errors:R,currentLocation:d+C,expectedLocation:d,distance:s,ignoreLocation:l})<=p?O=C:y=C,C=Math.floor((y-O)/2+O);y=C;let z=Math.max(1,d-C+1),S=i?h:Math.min(d+C,h)+u,M=Array(S+2);M[S+1]=(1<<R)-1;for(let T=S;T>=z;T-=1){let P=T-1,K=r[t.charAt(P)];if(_&&(I[P]=+!!K),M[T]=(M[T+1]<<1|1)&K,R&&(M[T]|=(w[T+1]|w[T])<<1|1|w[T+1]),M[T]&V&&(b=G(e,{errors:R,currentLocation:P,expectedLocation:d,distance:s,ignoreLocation:l}),b<=p)){if(p=b,E=P,E<=d)break;z=Math.max(1,2*d-E)}}if(G(e,{errors:R+1,currentLocation:d,expectedLocation:d,distance:s,ignoreLocation:l})>p)break;w=M}const D={isMatch:E>=0,score:Math.max(.001,b)};if(_){const R=wt(I,a);R.length?c&&(D.indices=R):D.isMatch=!1}return D}function kt(t){let e={};for(let r=0,n=t.length;r<n;r+=1){const s=t.charAt(r);e[s]=(e[s]||0)|1<<n-r-1}return e}class De{constructor(e,{location:r=f.location,threshold:n=f.threshold,distance:s=f.distance,includeMatches:o=f.includeMatches,findAllMatches:i=f.findAllMatches,minMatchCharLength:a=f.minMatchCharLength,isCaseSensitive:c=f.isCaseSensitive,ignoreLocation:l=f.ignoreLocation}={}){if(this.options={location:r,threshold:n,distance:s,includeMatches:o,findAllMatches:i,minMatchCharLength:a,isCaseSensitive:c,ignoreLocation:l},this.pattern=c?e:e.toLowerCase(),this.chunks=[],!this.pattern.length)return;const u=(d,p)=>{this.chunks.push({pattern:d,alphabet:kt(d),startIndex:p})},h=this.pattern.length;if(h>v){let d=0;const p=h%v,E=h-p;for(;d<E;)u(this.pattern.substr(d,v),d),d+=v;if(p){const _=h-v;u(this.pattern.substr(_),_)}}else u(this.pattern,0)}searchIn(e){const{isCaseSensitive:r,includeMatches:n}=this.options;if(r||(e=e.toLowerCase()),this.pattern===e){let E={isMatch:!0,score:0};return n&&(E.indices=[[0,e.length-1]]),E}const{location:s,distance:o,threshold:i,findAllMatches:a,minMatchCharLength:c,ignoreLocation:l}=this.options;let u=[],h=0,d=!1;this.chunks.forEach(({pattern:E,alphabet:_,startIndex:I})=>{const{isMatch:A,score:w,indices:b}=Ut(e,E,_,{location:s+I,distance:o,threshold:i,findAllMatches:a,minMatchCharLength:c,includeMatches:n,ignoreLocation:l});A&&(d=!0),h+=w,A&&b&&(u=[...u,...b])});let p={isMatch:d,score:d?h/this.chunks.length:1};return d&&n&&(p.indices=u),p}}class F{constructor(e){this.pattern=e}static isMultiMatch(e){return ge(e,this.multiRegex)}static isSingleMatch(e){return ge(e,this.singleRegex)}search(){}}function ge(t,e){const r=t.match(e);return r?r[1]:null}class Pt extends F{constructor(e){super(e)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(e){const r=e===this.pattern;return{isMatch:r,score:r?0:1,indices:[0,this.pattern.length-1]}}}class $t extends F{constructor(e){super(e)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(e){const n=e.indexOf(this.pattern)===-1;return{isMatch:n,score:n?0:1,indices:[0,e.length-1]}}}class Ft extends F{constructor(e){super(e)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(e){const r=e.startsWith(this.pattern);return{isMatch:r,score:r?0:1,indices:[0,this.pattern.length-1]}}}class vt extends F{constructor(e){super(e)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(e){const r=!e.startsWith(this.pattern);return{isMatch:r,score:r?0:1,indices:[0,e.length-1]}}}class Dt extends F{constructor(e){super(e)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(e){const r=e.endsWith(this.pattern);return{isMatch:r,score:r?0:1,indices:[e.length-this.pattern.length,e.length-1]}}}class Kt extends F{constructor(e){super(e)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(e){const r=!e.endsWith(this.pattern);return{isMatch:r,score:r?0:1,indices:[0,e.length-1]}}}class Ke extends F{constructor(e,{location:r=f.location,threshold:n=f.threshold,distance:s=f.distance,includeMatches:o=f.includeMatches,findAllMatches:i=f.findAllMatches,minMatchCharLength:a=f.minMatchCharLength,isCaseSensitive:c=f.isCaseSensitive,ignoreLocation:l=f.ignoreLocation}={}){super(e),this._bitapSearch=new De(e,{location:r,threshold:n,distance:s,includeMatches:o,findAllMatches:i,minMatchCharLength:a,isCaseSensitive:c,ignoreLocation:l})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(e){return this._bitapSearch.searchIn(e)}}class je extends F{constructor(e){super(e)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(e){let r=0,n;const s=[],o=this.pattern.length;for(;(n=e.indexOf(this.pattern,r))>-1;)r=n+o,s.push([n,r-1]);const i=!!s.length;return{isMatch:i,score:i?0:1,indices:s}}}const re=[Pt,je,Ft,vt,Kt,Dt,$t,Ke],_e=re.length,jt=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,Vt="|";function Gt(t,e={}){return t.split(Vt).map(r=>{let n=r.trim().split(jt).filter(o=>o&&!!o.trim()),s=[];for(let o=0,i=n.length;o<i;o+=1){const a=n[o];let c=!1,l=-1;for(;!c&&++l<_e;){const u=re[l];let h=u.isMultiMatch(a);h&&(s.push(new u(h,e)),c=!0)}if(!c)for(l=-1;++l<_e;){const u=re[l];let h=u.isSingleMatch(a);if(h){s.push(new u(h,e));break}}}return s})}const Ht=new Set([Ke.type,je.type]);class Wt{constructor(e,{isCaseSensitive:r=f.isCaseSensitive,includeMatches:n=f.includeMatches,minMatchCharLength:s=f.minMatchCharLength,ignoreLocation:o=f.ignoreLocation,findAllMatches:i=f.findAllMatches,location:a=f.location,threshold:c=f.threshold,distance:l=f.distance}={}){this.query=null,this.options={isCaseSensitive:r,includeMatches:n,minMatchCharLength:s,findAllMatches:i,ignoreLocation:o,location:a,threshold:c,distance:l},this.pattern=r?e:e.toLowerCase(),this.query=Gt(this.pattern,this.options)}static condition(e,r){return r.useExtendedSearch}searchIn(e){const r=this.query;if(!r)return{isMatch:!1,score:1};const{includeMatches:n,isCaseSensitive:s}=this.options;e=s?e:e.toLowerCase();let o=0,i=[],a=0;for(let c=0,l=r.length;c<l;c+=1){const u=r[c];i.length=0,o=0;for(let h=0,d=u.length;h<d;h+=1){const p=u[h],{isMatch:E,indices:_,score:I}=p.search(e);if(E){if(o+=1,a+=I,n){const A=p.constructor.type;Ht.has(A)?i=[...i,..._]:i.push(_)}}else{a=0,o=0,i.length=0;break}}if(o){let h={isMatch:!0,score:a/o};return n&&(h.indices=i),h}}return{isMatch:!1,score:1}}}const ne=[];function Bt(...t){ne.push(...t)}function se(t,e){for(let r=0,n=ne.length;r<n;r+=1){let s=ne[r];if(s.condition(t,e))return new s(t,e)}return new De(t,e)}const Y={AND:"$and",OR:"$or"},oe={PATH:"$path",PATTERN:"$val"},ie=t=>!!(t[Y.AND]||t[Y.OR]),Yt=t=>!!t[oe.PATH],Xt=t=>!U(t)&&Pe(t)&&!ie(t),Me=t=>({[Y.AND]:Object.keys(t).map(e=>({[e]:t[e]}))});function Ve(t,e,{auto:r=!0}={}){const n=s=>{let o=Object.keys(s);const i=Yt(s);if(!i&&o.length>1&&!ie(s))return n(Me(s));if(Xt(s)){const c=i?s[oe.PATH]:o[0],l=i?s[oe.PATTERN]:s[c];if(!L(l))throw new Error(Mt(c));const u={keyId:te(c),pattern:l};return r&&(u.searcher=se(l,e)),u}let a={children:[],operator:o[0]};return o.forEach(c=>{const l=s[c];U(l)&&l.forEach(u=>{a.children.push(n(u))})}),a};return ie(t)||(t=Me(t)),n(t)}function Qt(t,{ignoreFieldNorm:e=f.ignoreFieldNorm}){t.forEach(r=>{let n=1;r.matches.forEach(({key:s,norm:o,score:i})=>{const a=s?s.weight:null;n*=Math.pow(i===0&&a?Number.EPSILON:i,(a||1)*(e?1:o))}),r.score=n})}function zt(t,e){const r=t.matches;e.matches=[],N(r)&&r.forEach(n=>{if(!N(n.indices)||!n.indices.length)return;const{indices:s,value:o}=n;let i={indices:s,value:o};n.key&&(i.key=n.key.src),n.idx>-1&&(i.refIndex=n.idx),e.matches.push(i)})}function qt(t,e){e.score=t.score}function Jt(t,e,{includeMatches:r=f.includeMatches,includeScore:n=f.includeScore}={}){const s=[];return r&&s.push(zt),n&&s.push(qt),t.map(o=>{const{idx:i}=o,a={item:e[i],refIndex:i};return s.length&&s.forEach(c=>{c(o,a)}),a})}class j{constructor(e,r={},n){this.options={...f,...r},this.options.useExtendedSearch,this._keyStore=new St(this.options.keys),this.setCollection(e,n)}setCollection(e,r){if(this._docs=e,r&&!(r instanceof de))throw new Error(_t);this._myIndex=r||ve(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(e){N(e)&&(this._docs.push(e),this._myIndex.add(e))}remove(e=()=>!1){const r=[];for(let n=0,s=this._docs.length;n<s;n+=1){const o=this._docs[n];e(o,n)&&(this.removeAt(n),n-=1,s-=1,r.push(o))}return r}removeAt(e){this._docs.splice(e,1),this._myIndex.removeAt(e)}getIndex(){return this._myIndex}search(e,{limit:r=-1}={}){const{includeMatches:n,includeScore:s,shouldSort:o,sortFn:i,ignoreFieldNorm:a}=this.options;let c=L(e)?L(this._docs[0])?this._searchStringList(e):this._searchObjectList(e):this._searchLogical(e);return Qt(c,{ignoreFieldNorm:a}),o&&c.sort(i),ke(r)&&r>-1&&(c=c.slice(0,r)),Jt(c,this._docs,{includeMatches:n,includeScore:s})}_searchStringList(e){const r=se(e,this.options),{records:n}=this._myIndex,s=[];return n.forEach(({v:o,i,n:a})=>{if(!N(o))return;const{isMatch:c,score:l,indices:u}=r.searchIn(o);c&&s.push({item:o,idx:i,matches:[{score:l,value:o,norm:a,indices:u}]})}),s}_searchLogical(e){const r=Ve(e,this.options),n=(a,c,l)=>{if(!a.children){const{keyId:h,searcher:d}=a,p=this._findMatches({key:this._keyStore.get(h),value:this._myIndex.getValueForItemAtKeyId(c,h),searcher:d});return p&&p.length?[{idx:l,item:c,matches:p}]:[]}const u=[];for(let h=0,d=a.children.length;h<d;h+=1){const p=a.children[h],E=n(p,c,l);if(E.length)u.push(...E);else if(a.operator===Y.AND)return[]}return u},s=this._myIndex.records,o={},i=[];return s.forEach(({$:a,i:c})=>{if(N(a)){let l=n(r,a,c);l.length&&(o[c]||(o[c]={idx:c,item:a,matches:[]},i.push(o[c])),l.forEach(({matches:u})=>{o[c].matches.push(...u)}))}}),i}_searchObjectList(e){const r=se(e,this.options),{keys:n,records:s}=this._myIndex,o=[];return s.forEach(({$:i,i:a})=>{if(!N(i))return;let c=[];n.forEach((l,u)=>{c.push(...this._findMatches({key:l,value:i[u],searcher:r}))}),c.length&&o.push({idx:a,item:i,matches:c})}),o}_findMatches({key:e,value:r,searcher:n}){if(!N(r))return[];let s=[];if(U(r))r.forEach(({v:o,i,n:a})=>{if(!N(o))return;const{isMatch:c,score:l,indices:u}=n.searchIn(o);c&&s.push({score:l,key:e,value:o,idx:i,norm:a,indices:u})});else{const{v:o,n:i}=r,{isMatch:a,score:c,indices:l}=n.searchIn(o);a&&s.push({score:c,key:e,value:o,norm:i,indices:l})}return s}}j.version="7.0.0";j.createIndex=ve;j.parseIndex=Lt;j.config=f;j.parseQuery=Ve;Bt(Wt);const Zt=Ne(),H=`searchFilteredValue-${Zt}`,er=Q({inputSearch:{name:"1csfjum-emotion-inputSearch",styles:"max-width:234px;label:emotion-inputSearch;"}});function ae({dataSource:t,columns:e,fuseOptions:r,searchInputProps:n,onFilter:s,...o}){const i=m.useId(),[a]=m.useState(Ne),c=m.useMemo(()=>`table-search-${i}-${a}`,[a,i]),{t:l}=Ie(),[u,h]=m.useState(o.search??""),d=o.search??u,[p,E]=m.useState(d),_=Z(function(){E(d)}),[I]=m.useState(()=>st(_,ot(.3)));rt(d,I);const A=Z(function(M){var k;h(M.target.value),(k=o.onSearchChange)==null||k.call(o,M.target.value)}),w=m.useMemo(()=>new j(t,r),[t,r]),b=m.useMemo(()=>!!p,[p]),y=m.useMemo(()=>p?w.search(p):null,[w,p]),V=m.useCallback(function S(M){return{...it(M,["sortOrder","sorter"]),sortDirections:[null],showSorterTooltip:!1,..."children"in M?{children:M.children.map(S)}:null}},[]),D=m.useMemo(()=>at(()=>e,S=>b?S.map(V):S,S=>[{key:c,hidden:!0,defaultFilteredValue:[H],filters:[{text:H,value:H}],onFilter:(M,k)=>M!==H||!b?!0:y?(s==null?void 0:s(k))??y.some(({item:T})=>q(T,k)):!1,sorter:(M,k)=>{const T=(y==null?void 0:y.findIndex(({item:K})=>q(K,M)))??-1,P=(y==null?void 0:y.findIndex(({item:K})=>q(K,k)))??-1;return T===-1&&P===-1?0:T===-1?1:P===-1?-1:T-P},...b?{sortOrder:"ascend"}:null},...S])(),[c,e,y,s,b,V]),R=m.useMemo(()=>({placeholder:l("component.table.search.placeholder.default"),suffix:x(Se,{"un-i-motif":"magnifier",css:W({color:ce.colors.neutral006},";label:emotion-suffix;")})}),[l]),O=m.useMemo(()=>W([er.inputSearch,n==null?void 0:n.css],";label:emotion-mergedCss;"),[n==null?void 0:n.css]),C=m.useMemo(()=>{const S=Ae({},R,n);return x(nt,{...S,css:O,value:d,onChange:A})},[R,n,O,d,A]);return m.useMemo(()=>({searchInput:C,fuseResult:y,columns:D}),[y,D,C])}try{ae.displayName="useTableSearch",ae.__docgenInfo={description:`Hook to add search functionality to columns using Fuse.js.

If you want to use both search and column filters simultaneously, you should
always use this before the \`useColumnsFilter\` hook to ensure the search
functionality works correctly.

\`\`\`tsx
const tableSearchOptions = useMemo<Table.UseTableSearchOptions<RecordType>>(
 () => ({
   search,
   dataSource,
   columns,
   fuseOptions: {
     keys: ["firstName", "lastName", "address"],
   }
}), [columns, dataSource, search]);

const { columns } = useTableSearch(tableSearchOptions);

return <Table columns={columns} dataSource={dataSource} />;
\`\`\``,displayName:"useTableSearch",props:{dataSource:{defaultValue:null,description:"The data source for the table.",name:"dataSource",required:!0,type:{name:"TRecordType[]"}},columns:{defaultValue:null,description:"The columns of the table.",name:"columns",required:!0,type:{name:"ColumnsType<TRecordType>"}},search:{defaultValue:null,description:`The search query.

If this is empty, the search functionality will be disabled.

If this is not provided, it will use a local state to manage the search
query.`,name:"search",required:!1,type:{name:"string"}},onSearchChange:{defaultValue:null,description:"The callback function that is called when the search query changes.",name:"onSearchChange",required:!1,type:{name:"(search: string) => void"}},fuseOptions:{defaultValue:null,description:"The options for the Fuse.js instance.\n\nYou might want to set the `keys` option to the keys of the `dataSource`.",name:"fuseOptions",required:!0,type:{name:"IFuseOptions<TRecordType>"}},searchInputProps:{defaultValue:null,description:"The props for the search input.",name:"searchInputProps",required:!1,type:{name:'Omit<any, "onChange" | "value">'}},onFilter:{defaultValue:null,description:"The `onFilter` function can be overridden. If the function returns a\nboolean value, filtering will be based on that result. If it returns\n`undefined`, filtering will use the search result. This allows for\ncustomizing whether a record should be filtered based on the search. For\nexample, to filter only the root records, you can set `onFilter` to:\n`(record) => isParent(record) ? undefined : true`.",name:"onFilter",required:!1,type:{name:"(record: TRecordType) => boolean"}}}}}catch{}const Te=Q({table:W({"@layer emotion-component":{"& .ant-table-tbody td, .ant-table-thead th":{verticalAlign:"middle"},"& .ant-table-thead > tr > th, .ant-table-thead > tr > td":{"&::before":{display:"none"},fontWeight:"normal"},"& .ant-table-cell":et,"& tr:hover":{"td.ant-table-column-sort":{background:"#fafafa"}},".ant-table-row:not(.ant-table-row-level-0) > td":{backgroundColor:ce.colors.neutral001}}},";label:emotion-table;"),empty:{name:"1hrwuxb-emotion-empty",styles:"min-height:366px;label:emotion-empty;"}}),tr={scroll:{x:1e3}},rr=m.forwardRef(function(e,r){const{t:n}=Ie(),s=m.useMemo(()=>Ae({},tr,e),[e]),{locale:o,loading:i,...a}=s,c=m.useMemo(()=>i&&(typeof i=="boolean"?{indicator:x(fe,{}),spinning:i}:{indicator:x(fe,{}),...i}),[i]),l=m.useMemo(()=>{const{emptyTextStyledCss:u,emptyText:h,...d}=o??{};return{emptyText:x(Be,{css:Te.empty,children:typeof h=="function"?h():h??n("common.noData")}),...d}},[o,n]);return x(ct,{css:Te.table,...a,loading:c,locale:l,ref:r})}),nr={ascendFirst:["ascend","descend","ascend"],descendFirst:["descend","ascend","descend"]},X=Object.assign(rr,{defaultLocale:ye,sortDirections:nr,useTableSearch:ae,ExpandIcon:we,ExpandLoading:Ue,ExpandError:Le});try{X.displayName="exports",X.__docgenInfo={description:"",displayName:"exports",props:{ref:{defaultValue:null,description:"",name:"ref",required:!1,type:{name:"Ref<Reference>"}},locale:{defaultValue:null,description:"",name:"locale",required:!1,type:{name:"TableLocale & { emptyTextStyledCss?: SerializedStyles; }"}},rowKey:{defaultValue:null,description:"Stricter typing for the `rowKey` prop.",name:"rowKey",required:!1,type:{name:"string | number | symbol | GetRowKey<RecordType>"}}}}}catch{}export{X as e};
