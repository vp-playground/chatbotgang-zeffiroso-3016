import{k as F,j as Qe,h as D,w as j,U as bt,W as Mt,Z as pt,n as Re,f as yt,x as Ke}from"./omit-LJmhX_jk.js";import{e as I,j as Ce}from"./presets-fZzeZ6Sn.js";import{r as t}from"./index-qCb0-TeD.js";import{r as Ue}from"./index-fivQpuRm.js";import{c as Me}from"./index-DbGQkxQ5.js";import{R as et}from"./index-NCLGaooH.js";var tt=t.forwardRef(function(e,s){var i=e.height,l=e.offsetY,v=e.offsetX,n=e.children,u=e.prefixCls,m=e.onInnerResize,S=e.innerProps,M=e.rtl,g=e.extra,r={},c={display:"flex",flexDirection:"column"};return l!==void 0&&(r={height:i,position:"relative",overflow:"hidden"},c=F(F({},c),{},I(I(I(I(I({transform:"translateY(".concat(l,"px)")},M?"marginRight":"marginLeft",-v),"position","absolute"),"left",0),"right",0),"top",0))),t.createElement("div",{style:r},t.createElement(et,{onResize:function(R){var h=R.offsetHeight;h&&m&&m()}},t.createElement("div",Qe({style:c,className:Me(I({},"".concat(u,"-holder-inner"),u)),ref:s},S),n,g)))});tt.displayName="Filler";function Ge(e,s){var i="touches"in e?e.touches[0]:e;return i[s?"pageX":"pageY"]}var Ze=t.forwardRef(function(e,s){var i=e.prefixCls,l=e.rtl,v=e.scrollOffset,n=e.scrollRange,u=e.onStartMove,m=e.onStopMove,S=e.onScroll,M=e.horizontal,g=e.spinSize,r=e.containerSize,c=e.style,d=e.thumbStyle,R=t.useState(!1),h=D(R,2),f=h[0],p=h[1],y=t.useState(null),H=D(y,2),_=H[0],W=H[1],X=t.useState(null),E=D(X,2),B=E[0],C=E[1],P=!l,k=t.useRef(),Q=t.useRef(),x=t.useState(!1),$=D(x,2),ee=$[0],te=$[1],U=t.useRef(),T=function(){clearTimeout(U.current),te(!0),U.current=setTimeout(function(){te(!1)},3e3)},G=n-r||0,ie=r-g||0,Z=t.useMemo(function(){if(v===0||G===0)return 0;var w=v/G;return w*ie},[v,G,ie]),re=function(L){L.stopPropagation(),L.preventDefault()},q=t.useRef({top:Z,dragging:f,pageY:_,startTop:B});q.current={top:Z,dragging:f,pageY:_,startTop:B};var le=function(L){p(!0),W(Ge(L,M)),C(q.current.top),u(),L.stopPropagation(),L.preventDefault()};t.useEffect(function(){var w=function(se){se.preventDefault()},L=k.current,N=Q.current;return L.addEventListener("touchstart",w),N.addEventListener("touchstart",le),function(){L.removeEventListener("touchstart",w),N.removeEventListener("touchstart",le)}},[]);var ue=t.useRef();ue.current=G;var be=t.useRef();be.current=ie,t.useEffect(function(){if(f){var w,L=function(se){var fe=q.current,pe=fe.dragging,ye=fe.pageY,Ee=fe.startTop;if(j.cancel(w),pe){var ne=Ge(se,M)-ye,ve=Ee;!P&&M?ve-=ne:ve+=ne;var de=ue.current,ae=be.current,xe=ae?ve/ae:0,V=Math.ceil(xe*de);V=Math.max(V,0),V=Math.min(V,de),w=j(function(){S(V,M)})}},N=function(){p(!1),m()};return window.addEventListener("mousemove",L),window.addEventListener("touchmove",L),window.addEventListener("mouseup",N),window.addEventListener("touchend",N),function(){window.removeEventListener("mousemove",L),window.removeEventListener("touchmove",L),window.removeEventListener("mouseup",N),window.removeEventListener("touchend",N),j.cancel(w)}}},[f]),t.useEffect(function(){T()},[v]),t.useImperativeHandle(s,function(){return{delayHidden:T}});var A="".concat(i,"-scrollbar"),O={position:"absolute",visibility:ee?null:"hidden"},Y={position:"absolute",background:"rgba(0, 0, 0, 0.5)",borderRadius:99,cursor:"pointer",userSelect:"none"};return M?(O.height=8,O.left=0,O.right=0,O.bottom=0,Y.height="100%",Y.width=g,P?Y.left=Z:Y.right=Z):(O.width=8,O.top=0,O.bottom=0,P?O.right=0:O.left=0,Y.width="100%",Y.height=g,Y.top=Z),t.createElement("div",{ref:k,className:Me(A,I(I(I({},"".concat(A,"-horizontal"),M),"".concat(A,"-vertical"),!M),"".concat(A,"-visible"),ee)),style:F(F({},O),c),onMouseDown:re,onMouseMove:T},t.createElement("div",{ref:Q,className:Me("".concat(A,"-thumb"),I({},"".concat(A,"-thumb-moving"),f)),style:F(F({},Y),d),onMouseDown:le}))});function Et(e){var s=e.children,i=e.setRef,l=t.useCallback(function(v){i(v)},[]);return t.cloneElement(s,{ref:l})}function xt(e,s,i,l,v,n,u){var m=u.getKey;return e.slice(s,i+1).map(function(S,M){var g=s+M,r=n(S,g,{style:{width:l}}),c=m(S);return t.createElement(Et,{key:c,setRef:function(R){return v(S,R)}},r)})}var wt=function(){function e(){Mt(this,e),I(this,"maps",void 0),I(this,"id",0),this.maps=Object.create(null)}return bt(e,[{key:"set",value:function(i,l){this.maps[i]=l,this.id+=1}},{key:"get",value:function(i){return this.maps[i]}}]),e}();function zt(e,s,i){var l=t.useState(0),v=D(l,2),n=v[0],u=v[1],m=t.useRef(new Map),S=t.useRef(new wt),M=t.useRef();function g(){j.cancel(M.current)}function r(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;g();var R=function(){m.current.forEach(function(f,p){if(f&&f.offsetParent){var y=pt(f),H=y.offsetHeight;S.current.get(p)!==H&&S.current.set(p,y.offsetHeight)}}),u(function(f){return f+1})};d?R():M.current=j(R)}function c(d,R){var h=e(d);m.current.get(h),R?(m.current.set(h,R),r()):m.current.delete(h)}return t.useEffect(function(){return g},[]),[c,r,S.current,n]}var _t=10;function Lt(e,s,i,l,v,n,u,m){var S=t.useRef(),M=t.useState(null),g=D(M,2),r=g[0],c=g[1];return Re(function(){if(r&&r.times<_t){if(!e.current){c(function(G){return F({},G)});return}n();var d=r.targetAlign,R=r.originAlign,h=r.index,f=r.offset,p=e.current.clientHeight,y=!1,H=d,_=null;if(p){for(var W=d||R,X=0,E=0,B=0,C=Math.min(s.length-1,h),P=0;P<=C;P+=1){var k=v(s[P]);E=X;var Q=i.get(k);B=E+(Q===void 0?l:Q),X=B}for(var x=W==="top"?f:p-f,$=C;$>=0;$-=1){var ee=v(s[$]),te=i.get(ee);if(te===void 0){y=!0;break}if(x-=te,x<=0)break}switch(W){case"top":_=E-f;break;case"bottom":_=B-p+f;break;default:{var U=e.current.scrollTop,T=U+p;E<U?H="top":B>T&&(H="bottom")}}_!==null&&u(_),_!==r.lastTop&&(y=!0)}y&&c(F(F({},r),{},{times:r.times+1,targetAlign:H,lastTop:_}))}},[r,e.current]),function(d){if(d==null){m();return}if(j.cancel(S.current),typeof d=="number")u(d);else if(d&&Ce(d)==="object"){var R,h=d.align;"index"in d?R=d.index:R=s.findIndex(function(y){return v(y)===d.key});var f=d.offset,p=f===void 0?0:f;c({times:0,index:R,offset:p,originAlign:h})}}}function Dt(e,s,i){var l=e.length,v=s.length,n,u;if(l===0&&v===0)return null;l<v?(n=e,u=s):(n=s,u=e);var m={__EMPTY_ITEM__:!0};function S(R){return R!==void 0?i(R):m}for(var M=null,g=Math.abs(l-v)!==1,r=0;r<u.length;r+=1){var c=S(n[r]),d=S(u[r]);if(c!==d){M=r,g=g||c!==S(u[r+1]);break}}return M===null?null:{index:M,multiple:g}}function Ht(e,s,i){var l=t.useState(e),v=D(l,2),n=v[0],u=v[1],m=t.useState(null),S=D(m,2),M=S[0],g=S[1];return t.useEffect(function(){var r=Dt(n||[],e||[],s);(r==null?void 0:r.index)!==void 0&&g(e[r.index]),u(e)},[e]),[M]}var qe=(typeof navigator>"u"?"undefined":Ce(navigator))==="object"&&/Firefox/i.test(navigator.userAgent);const rt=function(e,s){var i=t.useRef(!1),l=t.useRef(null);function v(){clearTimeout(l.current),i.current=!0,l.current=setTimeout(function(){i.current=!1},50)}var n=t.useRef({top:e,bottom:s});return n.current.top=e,n.current.bottom=s,function(u){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,S=u<0&&n.current.top||u>0&&n.current.bottom;return m&&S?(clearTimeout(l.current),i.current=!1):(!S||i.current)&&v(),!i.current&&S}};function Tt(e,s,i,l,v){var n=t.useRef(0),u=t.useRef(null),m=t.useRef(null),S=t.useRef(!1),M=rt(s,i);function g(f,p){j.cancel(u.current),n.current+=p,m.current=p,!M(p)&&(qe||f.preventDefault(),u.current=j(function(){var y=S.current?10:1;v(n.current*y),n.current=0}))}function r(f,p){v(p,!0),qe||f.preventDefault()}var c=t.useRef(null),d=t.useRef(null);function R(f){if(e){j.cancel(d.current),d.current=j(function(){c.current=null},2);var p=f.deltaX,y=f.deltaY,H=f.shiftKey,_=p,W=y;(c.current==="sx"||!c.current&&H&&y&&!p)&&(_=y,W=0,c.current="sx");var X=Math.abs(_),E=Math.abs(W);c.current===null&&(c.current=l&&X>E?"x":"y"),c.current==="y"?g(f,W):r(f,_)}}function h(f){e&&(S.current=f.detail===m.current)}return[R,h]}var It=14/15;function Ct(e,s,i){var l=t.useRef(!1),v=t.useRef(0),n=t.useRef(null),u=t.useRef(null),m,S=function(c){if(l.current){var d=Math.ceil(c.touches[0].pageY),R=v.current-d;v.current=d,i(R)&&c.preventDefault(),clearInterval(u.current),u.current=setInterval(function(){R*=It,(!i(R,!0)||Math.abs(R)<=.1)&&clearInterval(u.current)},16)}},M=function(){l.current=!1,m()},g=function(c){m(),c.touches.length===1&&!l.current&&(l.current=!0,v.current=Math.ceil(c.touches[0].pageY),n.current=c.target,n.current.addEventListener("touchmove",S),n.current.addEventListener("touchend",M))};m=function(){n.current&&(n.current.removeEventListener("touchmove",S),n.current.removeEventListener("touchend",M))},Re(function(){return e&&s.current.addEventListener("touchstart",g),function(){var r;(r=s.current)===null||r===void 0||r.removeEventListener("touchstart",g),m(),clearInterval(u.current)}},[e])}var Pt=20;function Je(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=e/s*e;return isNaN(i)&&(i=0),i=Math.max(i,Pt),Math.floor(i)}function kt(e,s,i,l){var v=t.useMemo(function(){return[new Map,[]]},[e,i.id,l]),n=D(v,2),u=n[0],m=n[1],S=function(g){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:g,c=u.get(g),d=u.get(r);if(c===void 0||d===void 0)for(var R=e.length,h=m.length;h<R;h+=1){var f,p=e[h],y=s(p);u.set(y,h);var H=(f=i.get(y))!==null&&f!==void 0?f:l;if(m[h]=(m[h-1]||0)+H,y===g&&(c=h),y===r&&(d=h),c!==void 0&&d!==void 0)break}return{top:m[c-1]||0,bottom:m[d]}};return S}var Ot=["prefixCls","className","height","itemHeight","fullHeight","style","data","children","itemKey","virtual","direction","scrollWidth","component","onScroll","onVirtualScroll","onVisibleChange","innerProps","extraRender","styles"],$t=[],Nt={overflowY:"auto",overflowAnchor:"none"};function Ft(e,s){var i=e.prefixCls,l=i===void 0?"rc-virtual-list":i,v=e.className,n=e.height,u=e.itemHeight,m=e.fullHeight,S=m===void 0?!0:m,M=e.style,g=e.data,r=e.children,c=e.itemKey,d=e.virtual,R=e.direction,h=e.scrollWidth,f=e.component,p=f===void 0?"div":f,y=e.onScroll,H=e.onVirtualScroll,_=e.onVisibleChange,W=e.innerProps,X=e.extraRender,E=e.styles,B=yt(e,Ot),C=!!(d!==!1&&n&&u),P=C&&g&&(u*g.length>n||!!h),k=R==="rtl",Q=Me(l,I({},"".concat(l,"-rtl"),k),v),x=g||$t,$=t.useRef(),ee=t.useRef(),te=t.useState(0),U=D(te,2),T=U[0],G=U[1],ie=t.useState(0),Z=D(ie,2),re=Z[0],q=Z[1],le=t.useState(!1),ue=D(le,2),be=ue[0],A=ue[1],O=function(){A(!0)},Y=function(){A(!1)},w=t.useCallback(function(a){return typeof c=="function"?c(a):a==null?void 0:a[c]},[c]),L={getKey:w};function N(a){G(function(o){var b;typeof a=="function"?b=a(o):b=a;var z=ut(b);return $.current.scrollTop=z,z})}var ce=t.useRef({start:0,end:x.length}),se=t.useRef(),fe=Ht(x,w),pe=D(fe,1),ye=pe[0];se.current=ye;var Ee=zt(w),ne=D(Ee,4),ve=ne[0],de=ne[1],ae=ne[2],xe=ne[3],V=t.useMemo(function(){if(!C)return{scrollHeight:void 0,start:0,end:x.length-1,offset:void 0};if(!P){var a;return{scrollHeight:((a=ee.current)===null||a===void 0?void 0:a.offsetHeight)||0,start:0,end:x.length-1,offset:void 0}}for(var o=0,b,z,J,St=x.length,ge=0;ge<St;ge+=1){var gt=x[ge],Rt=w(gt),Ae=ae.get(Rt),Ie=o+(Ae===void 0?u:Ae);Ie>=T&&b===void 0&&(b=ge,z=o),Ie>T+n&&J===void 0&&(J=ge),o=Ie}return b===void 0&&(b=0,z=0,J=Math.ceil(n/u)),J===void 0&&(J=x.length-1),J=Math.min(J+1,x.length-1),{scrollHeight:o,start:b,end:J,offset:z}},[P,C,T,x,xe,n]),oe=V.scrollHeight,he=V.start,me=V.end,Pe=V.offset;ce.current.start=he,ce.current.end=me;var nt=t.useState({width:0,height:n}),ke=D(nt,2),K=ke[0],at=ke[1],ot=function(o){at({width:o.width||o.offsetWidth,height:o.height||o.offsetHeight})},Oe=t.useRef(),$e=t.useRef(),it=t.useMemo(function(){return Je(K.width,h)},[K.width,h]),lt=t.useMemo(function(){return Je(K.height,oe)},[K.height,oe]),we=oe-n,ze=t.useRef(we);ze.current=we;function ut(a){var o=a;return Number.isNaN(ze.current)||(o=Math.min(o,ze.current)),o=Math.max(o,0),o}var Ne=T<=0,Fe=T>=we,ct=rt(Ne,Fe),_e=function(){return{x:k?-re:re,y:T}},Le=t.useRef(_e()),De=Ke(function(){if(H){var a=_e();(Le.current.x!==a.x||Le.current.y!==a.y)&&(H(a),Le.current=a)}});function Ye(a,o){var b=a;o?(Ue.flushSync(function(){q(b)}),De()):N(b)}function st(a){var o=a.currentTarget.scrollTop;o!==T&&N(o),y==null||y(a),De()}var He=function(o){var b=o,z=h-K.width;return b=Math.max(b,0),b=Math.min(b,z),b},ft=Ke(function(a,o){o?(Ue.flushSync(function(){q(function(b){var z=b+(k?-a:a);return He(z)})}),De()):N(function(b){var z=b+a;return z})}),vt=Tt(C,Ne,Fe,!!h,ft),We=D(vt,2),Te=We[0],Xe=We[1];Ct(C,$,function(a,o){return ct(a,o)?!1:(Te({preventDefault:function(){},deltaY:a}),!0)}),Re(function(){function a(b){C&&b.preventDefault()}var o=$.current;return o.addEventListener("wheel",Te),o.addEventListener("DOMMouseScroll",Xe),o.addEventListener("MozMousePixelScroll",a),function(){o.removeEventListener("wheel",Te),o.removeEventListener("DOMMouseScroll",Xe),o.removeEventListener("MozMousePixelScroll",a)}},[C]),Re(function(){h&&q(function(a){return He(a)})},[K.width,h]);var Ve=function(){var o,b;(o=Oe.current)===null||o===void 0||o.delayHidden(),(b=$e.current)===null||b===void 0||b.delayHidden()},je=Lt($,x,ae,u,w,function(){return de(!0)},N,Ve);t.useImperativeHandle(s,function(){return{getScrollInfo:_e,scrollTo:function(o){function b(z){return z&&Ce(z)==="object"&&("left"in z||"top"in z)}b(o)?(o.left!==void 0&&q(He(o.left)),je(o.top)):je(o)}}}),Re(function(){if(_){var a=x.slice(he,me+1);_(a,x)}},[he,me,x]);var dt=kt(x,w,ae,u),ht=X==null?void 0:X({start:he,end:me,virtual:P,offsetX:re,offsetY:Pe,rtl:k,getSize:dt}),mt=xt(x,he,me,h,ve,r,L),Se=null;n&&(Se=F(I({},S?"height":"maxHeight",n),Nt),C&&(Se.overflowY="hidden",h&&(Se.overflowX="hidden"),be&&(Se.pointerEvents="none")));var Be={};return k&&(Be.dir="rtl"),t.createElement("div",Qe({style:F(F({},M),{},{position:"relative"}),className:Q},Be,B),t.createElement(et,{onResize:ot},t.createElement(p,{className:"".concat(l,"-holder"),style:Se,ref:$,onScroll:st,onMouseEnter:Ve},t.createElement(tt,{prefixCls:l,height:oe,offsetX:re,offsetY:Pe,scrollWidth:h,onInnerResize:de,ref:ee,innerProps:W,rtl:k,extra:ht},mt))),P&&oe>n&&t.createElement(Ze,{ref:Oe,prefixCls:l,scrollOffset:T,scrollRange:oe,rtl:k,onScroll:Ye,onStartMove:O,onStopMove:Y,spinSize:lt,containerSize:K.height,style:E==null?void 0:E.verticalScrollBar,thumbStyle:E==null?void 0:E.verticalScrollBarThumb}),P&&h>K.width&&t.createElement(Ze,{ref:$e,prefixCls:l,scrollOffset:re,scrollRange:h,rtl:k,onScroll:Ye,onStartMove:O,onStopMove:Y,spinSize:it,containerSize:K.width,horizontal:!0,style:E==null?void 0:E.horizontalScrollBar,thumbStyle:E==null?void 0:E.horizontalScrollBarThumb}))}var Yt=t.forwardRef(Ft);Yt.displayName="List";export{Yt as L};
