import{j as l,a as S,F as N}from"./emotion-react-jsx-runtime.browser.esm-B6nDGTOp.js";import{a as H}from"./assignDisplayName-lT0r0-ot.js";import{u as M}from"./useHandler-HI23tEoY.js";import{r as He}from"./random-CmfFXdz5.js";import{c as R}from"./emotion-react.browser.esm-DKbCFQzN.js";import{u as Oe}from"./index-CVRwA_xR.js";import{t as le}from"./index-BA0eH0Wu.js";import{m as j}from"./memo-BZYTsoqr.js";import{c as G,s as Q}from"./traditional-B_ldJKp3.js";import{r as d}from"./index-qCb0-TeD.js";import{T as Ee}from"./Trans-B7RBgX3a.js";import{H as je}from"./context-bgT8s9yI.js";import{B as q}from"./index-DIYPjkqE.js";import{M as Le}from"./index-H7DGQcO_.js";import{u as qe}from"./useTranslation-XVYQH2mr.js";import{f as We}from"./shouldProcessLinkClick-Cauo1FQC.js";import{T as U,N as ze,u as Ge}from"./navigate-CRWb9NLN.js";import{p as Qe}from"./index-CwLK_-iS.js";import{a as Ke}from"./index-BPqQDtUc.js";import{g as Ye}from"./getDisplayName-Cdt1H-sM.js";import{A as ce}from"./appConstant-DrkG7OWi.js";import{u as Ze,i as Je,o as T}from"./orgQueriesContext-CTNIHlpq.js";import{c as Xe}from"./dummy-T6UpgMGd.js";import{c as Pe}from"./createContext-Co4ks8zE.js";import{t as ue}from"./index-BQ-NB-n4.js";import{c as et}from"./emotion-styled-base.browser.esm-DcS0-Etw.js";import{u as tt}from"./index-DPz6_WSv.js";import{E as rt}from"./index-Ds41-CWB.js";import{d as nt}from"./delay-CaiE5JvH.js";import{d as we}from"./index-gEP6Tn1u.js";import{F as b}from"./index-DvseeTEo.js";import{i as Fe}from"./isNil-C7mktj5T.js";import{i as B}from"./sentry-DXsovuw2.js";import{u as ot}from"./uniq-BL7hiWVS.js";import{h as st}from"./pick-BRmevVyy.js";import{g as at}from"./get-DGJ4vF0c.js";import{s as it,I as Ne}from"./index-ADXJD4hY.js";import{P as Ae}from"./index-DHqc_-FW.js";import{R as de}from"./index-DrK2RkJp.js";import{f as xe}from"./flow-Caod8tMH.js";import{d as lt}from"./safeString-CSiFDyUi.js";import{d as ct}from"./define-D3i8B5cg.js";import{d as ut}from"./models-D08OMJcb.js";function X(e){const t=e;return t.getInternalHooks.bind(t)(je)}function dt(){const e=G()(()=>({stack:[]}),Q);function t(a=void 0){const n=d.useId(),o=M(function(){e.setState(f=>f.stack.some(i=>i.id===n)?{stack:f.stack.map(i=>i.id===n?{id:n,value:a}:i)}:{stack:[...f.stack,{id:n,value:a}]})}),m=M(function(){const f=e.getState().stack;f.find(c=>c.id===n)&&e.setState(()=>({stack:f.filter(c=>c.id!==n)}))});d.useEffect(()=>(o(),m),[m,o]),Oe(a,o)}const r=j(function({value:n}){return t(n),null});function s(){return e(a=>a.stack.map(n=>n.value))}return{useItem:t,Item:r,useStack:s,useStore:e}}function ve(e){return e instanceof Object&&"currentTarget"in e&&e.currentTarget instanceof HTMLButtonElement}const ee=j(function(t){const{t:r}=qe();return l(Le,{title:r("common.unsaved.title"),footer:[l(q,{type:"default",onClick:s=>{var a;ve(s)&&((a=t.onOk)==null||a.call(t,s))},children:r("common.unsaved.leave")},"cancel"),l(q,{type:"primary",onClick:s=>{var a;ve(s)&&((a=t.onCancel)==null||a.call(t,s))},children:r("common.unsaved.keepEditing")},"submit")],...t,children:t.children??r("common.unsaved.desc")})});try{ee.displayName="BlockerUi",ee.__docgenInfo={description:`The default UI from RouterPrompt. You can override this component with all
the props from Ant Design Modal.

onOk: The handler when the user clicks the leave button.
onCancel: The handler when the user clicks the keep editing button.`,displayName:"BlockerUi",props:{}}}catch{}const Ve=dt();function W(e=!0){Ve.useItem(e)}const te=({block:e=!0})=>(W(e),null),re=()=>{const e=We(({currentLocation:t,nextLocation:r})=>Ve.useStore.getState().stack.filter(s=>s.value).length>0&&t.pathname!==r.pathname);return e.state!=="blocked"?null:l(ee,{open:!0,onCancel:t=>{t.defaultPrevented||e.reset()},onOk:t=>{t.defaultPrevented||e.proceed()}})};try{te.displayName="Blocker",te.__docgenInfo={description:"If you want to block the navigation, you can use this component.",displayName:"Blocker",props:{block:{defaultValue:{value:"true"},description:"",name:"block",required:!1,type:{name:"boolean"}}}}}catch{}try{re.displayName="RouterBlocker",re.__docgenInfo={description:"",displayName:"RouterBlocker",props:{}}}catch{}try{W.displayName="useBlocker",W.__docgenInfo={description:"If you want to block the navigation, you can use this hook.",displayName:"useBlocker",props:{}}}catch{}function ne(e){const t=Ze();if(Je(e))return null;const r=e.getTime()-t.getTime(),s=Math.floor(r/(1e3*60*60*24)),a=Math.floor(r/(1e3*60*60)%24),n=Math.floor(r/(1e3*60)%60),o=Math.floor(r/1e3%60);return{days:s,hours:a,minutes:n,seconds:o}}const oe=function({targetDate:t}){const r=ne(t);if(!r)return null;const{days:s,hours:a,minutes:n,seconds:o}=r;return S(N,{children:[s,"d, ",a,"h, ",n,"m, ",o,"s"]})};try{oe.displayName="CountDown",oe.__docgenInfo={description:"",displayName:"CountDown",props:{targetDate:{defaultValue:null,description:"",name:"targetDate",required:!0,type:{name:"Date"}}}}}catch{}try{ne.displayName="useCountDown",ne.__docgenInfo={description:`Get the countdown to a target date. Returns null if the target date is
invalid.`,displayName:"useCountDown",props:{}}}catch{}function mt({formProps:e}={}){const t=e==null?void 0:e.form,[r,s]=d.useState(!1),a=d.useRef(!1);d.useEffect(()=>(a.current=!0,function(){a.current=!1}),[]);const n=M(async function(){a.current&&(await nt(1),a.current&&s(t?t.getFieldsError().some(p=>p.errors.length>0):!1))}),o=t&&X(t);return d.useEffect(function(){let p=!1;const f=o==null?void 0:o.registerWatch(function(){p||n()});return function(){p=!0,f==null||f()}},[o,n]),d.useEffect(()=>{if(t){n();return}s(!1)},[t,n]),{hasFieldsError:r}}const ft=(()=>{const e=new WeakMap;function t(s){if(e.has(s)){const n=e.get(s);if(!n)throw new Error("Unexpected undefined value");return n}const a=new rt;return(()=>{const{resetFields:n}=s;s.resetFields=(...o)=>(a.emit("resetFields",...o),n==null?void 0:n(...o))})(),e.set(s,a),a}function r(s,a,n){const o=d.useMemo(()=>s&&t(s),[s]);d.useEffect(()=>{if(o)return o.on(a,n),function(){o.off(a,n)}},[o,a,n])}return r})();function se({promptIfAnyFieldsError:e,disabled:t,formProps:r}={}){const[s,a]=tt(!1),{hasFieldsError:n}=mt({formProps:r}),o=M(function(..._){var h;const y=_[0];Object.keys(y).length>0?a.on():a.off(),(h=r==null?void 0:r.onValuesChange)==null||h.call(r,..._)}),m=M(function(..._){var y;a.off(),(y=r==null?void 0:r.onReset)==null||y.call(r,..._)});ft(r==null?void 0:r.form,"resetFields",a.off);const p=!t&&(s||!!e&&n),f=d.useMemo(()=>p?l(Be.Blocker,{}):null,[p]),i=d.useMemo(()=>({...r,onValuesChange:o,onReset:m}),[r,m,o]);return d.useMemo(()=>({routerPromptElement:f,formProps:i}),[i,f])}try{se.displayName="useRouterPrompt",se.__docgenInfo={description:"Do not use this hook directly. Use `Form` instead.",displayName:"useRouterPrompt",props:{disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}},promptIfAnyFieldsError:{defaultValue:null,description:"",name:"promptIfAnyFieldsError",required:!1,type:{name:"boolean"}},formProps:{defaultValue:null,description:"",name:"formProps",required:!1,type:{name:"FormProps<Values> & { children?: ReactNode; }"}}}}}catch{}function pt(e){return e(String.raw)}const gt=j(function(t){return null}),ae=et(b.Item,{shouldForwardProp:it(["$hideErrorExplanation"]),target:"e9xspd0",label:"emotion-FormItem"})(".ant-form-item-explain-error{",({$hideErrorExplanation:e=!1})=>e?pt(t=>t`
              display: none;
            `):"",";}"),De=we({autoHeightFormItem:{name:"sb58ff-emotion-autoHeightFormItem",styles:".ant-form-item{height:auto;margin-bottom:auto;};label:emotion-autoHeightFormItem;"},optionalMark:R({fontSize:"0.75rem",marginInlineStart:4,color:le.colors.neutral007},";label:emotion-optionalMark;")}),ht=(e,{required:t})=>S(N,{children:[e,t?null:l("span",{css:De.optionalMark,children:l(Ee,{i18nKey:"component.form.optional"})})]}),A=Object.assign(function({routerPromptOptions:t,autoHeightFormItem:r=!1,...s}){const a=se({...t,formProps:s}),n=s.requiredMark==="optional"?ht:s.requiredMark;return S(N,{children:[l(b,{css:R(r?De.autoHeightFormItem:null,";label:emotion-Form;"),...a.formProps,requiredMark:n}),a.routerPromptElement]})},{Item:ae,List:b.List,useForm:b.useForm,useFormInstance:b.useFormInstance,useWatch:b.useWatch,ValidateOnMount:j(function(){const t=b.useFormInstance();return d.useEffect(()=>{t.validateFields()},[t]),null}),HiddenInput:function(t){return l(b.Item,{noStyle:!0,...t,children:t.children??l(gt,{})})}});try{A.displayName="Form",A.__docgenInfo={description:"An enhanced version of Ant Design's Form component.\n\n- RouterPrompt is added to the form. Set `routerPromptOptions` to `false` to disable it.",displayName:"Form",props:{routerPromptOptions:{defaultValue:null,description:"",name:"routerPromptOptions",required:!1,type:{name:'Omit<RouterPromptOptions, "formProps">'}},autoHeightFormItem:{defaultValue:null,description:"",name:"autoHeightFormItem",required:!1,type:{name:"boolean"}}}}}catch{}try{ae.displayName="FormItem",ae.__docgenInfo={description:"",displayName:"FormItem",props:{theme:{defaultValue:null,description:"",name:"theme",required:!1,type:{name:"Theme"}},$hideErrorExplanation:{defaultValue:null,description:"",name:"$hideErrorExplanation",required:!1,type:{name:"boolean"}}}}}catch{}function z(e){return xe(()=>e,lt,t=>t.replaceAll(/[^a-zA-Z]+/g,""),t=>t.toLowerCase())()}const _e=function(){return{enabled:{enabledAt:Xe},disabled:{enabledAt:null}}}();function yt(){const e=G()(()=>({featureControls:[]}),Q);function t(){e.setState({featureControls:[]})}function r(){e.setState({featureControls:[]})}function s(o,m){e.setState(p=>({featureControls:[...p.featureControls.filter(i=>i.featureControl!==o),{featureControl:o,value:m?_e.enabled:_e.disabled}]}))}function a(o){e.setState(m=>({featureControls:m.featureControls.filter(p=>p.featureControl!==o)}))}return{useStore:e,clearFeatureControl:a,clearFeatureControls:t,clear:r,setFeatureControl:s}}const Re=Pe({name:"FeatureControlOverrideUtilsContext"}),me=Re.useContext,be=({children:e})=>{const[t]=d.useState(()=>yt());return l(Re.Provider,{value:t,children:e})},Ft=({featureControl:e})=>{const t=me(),r=t.useStore(n=>n.featureControls),s=d.useMemo(()=>{const n=r.find(m=>m.featureControl===e);if(!n)return"undefined";const o=n.value;return o.enabledAt!==null&&ce>=o.enabledAt?"true":"false"},[r,e]),a=M(n=>{const o=n.target.value;o==="true"?t.setFeatureControl(e,!0):o==="false"?t.setFeatureControl(e,!1):t.clearFeatureControl(e)});return l(de,{value:s,options:[{label:"Default",value:"undefined"},{label:"Enabled",value:"true"},{label:"Disabled",value:"false"}],onChange:a})},vt=({featureFlagKey:e})=>{const r=T.useData().featureControl[e].enabledAt,s=d.useMemo(()=>r!==null&&r<ce,[r]);return l(N,{children:r===null?null:l("div",{css:R({color:le.colors.neutral007},";label:emotion-EnabledMessage;"),children:s?"Enabled automatically":S(N,{children:["Count down to auto enable: ",l(oe,{targetDate:r})]})})})};var _t={name:"1f0win7-emotion-FeatureControlOverride",styles:"margin-bottom:0;.ant-form-item-label{padding-bottom:0;};label:emotion-FeatureControlOverride;"};const bt=()=>{const e=T.useData(),[t,r]=d.useState(""),s=d.useMemo(()=>z(t),[t]),a=d.useMemo(()=>ue.objectEntries(e.featureControl).flatMap(([n])=>!s||z(n).includes(s)?[n]:[]),[e.featureControl,s]);return S(N,{children:[l(U.Title,{level:5,children:"Feature controls"}),l(A.Item,{label:"Search",style:{marginBottom:"0.75rem"},children:l(Ne,{value:t,onChange:n=>r(n.target.value),allowClear:!0,prefix:l(Ae,{"un-i-ph":"magnifying-glass"})})}),a.length===0?l(U.Text,{type:"secondary",children:"No feature found"}):a.map(n=>l("div",{children:l(A.Item,{extra:l(vt,{featureFlagKey:n}),label:n,css:_t,children:l(Ft,{featureControl:n})})},n))]})},Ce=()=>{const e=me();return l(A,{layout:"vertical",children:S("div",{children:[S("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between"},children:[l(U.Title,{level:4,style:{flex:1},children:"Feature Control Override"}),l(q,{onClick:e.clear,children:"Reset"})]}),l(bt,{})]})})};try{Ce.displayName="FeatureControl",Ce.__docgenInfo={description:"",displayName:"FeatureControl",props:{}}}catch{}try{be.displayName="FeatureControlOverrideUtilsProvider",be.__docgenInfo={description:`The provider for feature control override utils.

Please make sure this provider will be mounted in a org context to make sure
the feature control override is org specific.`,displayName:"FeatureControlOverrideUtilsProvider",props:{}}}catch{}function Ue(){const e=T.useData(),r=me().useStore();return d.useMemo(()=>({...e.featureControl,...Object.fromEntries(r.featureControls.map(({featureControl:a,value:n})=>[a,n]))}),[e.featureControl,r.featureControls])}function Te(e,t){const r=e[t].enabledAt;return r!==null&&ce>=r}function ie(e){const t=Ue();return d.useMemo(()=>Te(t,e),[e,t])}function Ct(){const e=Ue();return d.useCallback(function(s){return Te(e,s)},[e])}function ke(e,t,r){const s=Ye(t),a=(m,p)=>{const i=ie(e)?t:(r==null?void 0:r.FallbackComponent)??d.Fragment;return l(i,{...m,ref:p})};H(a,s);const n=d.forwardRef(a),o=`withFeatureControl(${e})(${s})`;return H(n,o),n}try{ie.displayName="useFeatureControl",ie.__docgenInfo={description:"",displayName:"useFeatureControl",props:{}}}catch{}try{ke.displayName="WithFeatureControl",ke.__docgenInfo={description:"HOC for feature control.",displayName:"WithFeatureControl",props:{}}}catch{}const kt=ct({"/quick-templates":{permission:["editQuickTemplate"]},"/settings/users":{permission:["manageOrg"]},"/settings/teams":{permission:["editTeam"]},"/settings/teams/create":{permission:["createTeam"]},"/settings/chat-settings":{permission:["manageOrg"]},"/settings/assignment":{permission:["viewAssignmentGeneralSetting"]},"/settings/assignment/routing-rules/create":{permission:["editAutoAssignmentRule"]},"/settings/assignment/routing-rules/edit/:ruleId":{permission:["editAutoAssignmentRule"]},"/settings/org":{permission:["manageOrg"]},"/settings/channels":{permission:["manageOrg"]},"/insights":{permission:["viewDashboard"]},"/broadcasts/create":{featureControls:["broadcastAvailability"]}}),It={unlimitedTeamScope:["owner","primary_admin"],canAssignMembersInMyTeams:["admin"]};function Mt(){const e=G()(()=>({roleId:void 0,permissions:[]}),Q);function t(){e.setState({roleId:void 0})}function r(){e.setState({permissions:[]})}function s(){e.setState({roleId:void 0,permissions:[]})}function a(p){e.setState({roleId:p})}function n(p,f){e.setState(i=>({permissions:[...i.permissions.filter(u=>u.permission!==p),{permission:p,value:f}]}))}function o(p){e.setState(f=>({permissions:f.permissions.filter(i=>i.permission!==p)}))}return{useStore:e,clearRoleId:t,clearPermission:o,clearPermissions:r,clear:s,setRoleId:a,setPermission:n}}const $e=Pe({name:"PermissionOverrideUtilsContext"}),Ie=({children:e})=>{const[t]=d.useState(()=>Mt());return l($e.Provider,{value:t,children:e})},fe=$e.useContext,St=({permission:e})=>{const t=fe(),r=t.useStore(n=>n.permissions),s=d.useMemo(()=>{const n=r.find(o=>o.permission===e);return n?n.value?"true":"false":"undefined"},[r,e]),a=M(n=>{const o=n.target.value;o==="true"?t.setPermission(e,!0):o==="false"?t.setPermission(e,!1):t.clearPermission(e)});return l(de,{value:s,options:[{label:"Default",value:"undefined"},{label:"Allow",value:"true"},{label:"Deny",value:"false"}],onChange:a})},Ot=()=>{const e=T.useData(),t=pe(),r=d.useMemo(()=>e.roles.find(m=>m.id===t.roleId),[e.roles,t.roleId]),[s,a]=d.useState(""),n=d.useMemo(()=>z(s),[s]),o=d.useMemo(()=>r?ue.objectEntries(r.permission).flatMap(([m])=>!n||z(m).includes(n)?[m]:[]):[],[r,n]);return r?S(N,{children:[l(U.Title,{level:5,children:"Permissions"}),l(A.Item,{label:"Search",style:{marginBottom:"0.75rem"},children:l(Ne,{value:s,onChange:m=>a(m.target.value),allowClear:!0,prefix:l(Ae,{"un-i-ph":"magnifying-glass"})})}),o.length===0?l(U.Text,{type:"secondary",children:"No permission found"}):o.map(m=>l(A.Item,{label:m,style:{marginBottom:"0.5rem"},children:l(St,{permission:m})},m))]}):null},Me=()=>{const e=T.useData(),t=pe(),r=fe(),s=d.useMemo(()=>e.roles.map(o=>({label:o.name,value:o.id})),[e.roles]),a=d.useMemo(()=>e.roles.find(o=>o.id===t.roleId),[e.roles,t.roleId]),n=M(o=>{const m=o.target.value,p=e.roles.find(f=>f.id===m);p&&r.useStore.setState({roleId:p.id,permissions:xe(()=>p.permission,ue.objectEntries,f=>f.map(([i,c])=>({permission:i,value:c})))()})});return l(A,{layout:"vertical",children:S("div",{children:[S("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between"},children:[l(U.Title,{level:4,style:{flex:1},children:"Permission Override"}),l(q,{onClick:r.clear,children:"Reset"})]}),l(A.Item,{label:"Role",children:l(de,{value:t.roleId,options:s,onChange:n})}),a?l(Ot,{}):null]})})};try{Me.displayName="Permission",Me.__docgenInfo={description:"",displayName:"Permission",props:{}}}catch{}try{Ie.displayName="PermissionOverrideUtilsProvider",Ie.__docgenInfo={description:`The provider for permission override utils.

Please make sure this provider will be mounted in a org context to make sure
the permission override is org specific.`,displayName:"PermissionOverrideUtilsProvider",props:{}}}catch{}function Et(e){return ut.safeParse(e).success}function Pt({user:e,permissionName:t}){return Et(t)?e.permission[t]:It[t].includes(e.roleType)}function pe(){const e=T.useData(),t=e.me,s=fe().useStore(),a=e.roles,n=d.useMemo(()=>s.roleId?a.find(f=>f.id===s.roleId):void 0,[s.roleId,a]),o=d.useMemo(()=>({...t,...n?{roleId:n.id,roleType:n.type,roleName:n.name}:null,...s.permissions.length===0?null:{permission:{...t.permission,...Object.fromEntries(s.permissions.map(f=>[f.permission,f.value]))}}}),[t,s.permissions,n]),m=d.useCallback(function(i){return Pt({user:o,permissionName:i})},[o]);return d.useMemo(()=>({roleId:o.roleId,permission:o.permission,hasPermission:m}),[m,o.permission,o.roleId])}function wt(e){var r;return(r=Object.entries(kt).find(([s])=>Qe(s).test(e)))==null?void 0:r[1]}function Nt(){const{hasPermission:e}=pe(),t=Ke(),r=Ct();return d.useCallback(function(n){var E,w,x;const o=wt(n),m=(o==null?void 0:o.permission)??[],p=(o==null?void 0:o.featureFlags)??[],f=(o==null?void 0:o.featureControls)??[],i=((E=o==null?void 0:o.exclude)==null?void 0:E.permission)??[],c=((w=o==null?void 0:o.exclude)==null?void 0:w.featureFlags)??[],u=((x=o==null?void 0:o.exclude)==null?void 0:x.featureControls)??[],_=(i.length===0||i.every(C=>!e(C)))&&(m.length===0||m.every(C=>e(C))),y=(c.length===0||c.every(C=>!t(C)))&&(p.length===0||p.every(C=>t(C))),h=(u.length===0||u.every(C=>!r(C)))&&(f.length===0||f.every(C=>r(C)));return _&&y&&h},[t,e,r])}const At=Object.freeze(Object.defineProperty({__proto__:null,Blocker:te,Navigate:ze,RouterBlocker:re,useBlocker:W,useCheckRoutePermission:Nt,useNavigate:Ge},Symbol.toStringTag,{value:"Module"})),Be={...At},L=He(),g={labelMain:`labelMain-${L}`,afterLabel:`afterLabel-${L}`,optionalMark:`optionalMark-${L}`,colon:`colon-${L}`},J=we({autoHeightFormItem:{name:"sb58ff-emotion-autoHeightFormItem",styles:".ant-form-item{height:auto;margin-bottom:auto;};label:emotion-autoHeightFormItem;"},optionalMark:R({fontSize:"0.75rem",marginInlineStart:4,color:le.colors.neutral007},";label:emotion-optionalMark;"),item:R({".ant-form-item-label":{fontWeight:500},"& label":{".ant-form-vertical &:after":{display:"none"},[`.${g.afterLabel}`]:{textAlign:"end",marginLeft:"auto",fontWeight:"initial"},[`&:has(.${g.labelMain}):has(.${g.afterLabel})`]:{display:"grid",alignItems:"center",[`.${g.afterLabel}`]:{gridArea:g.afterLabel,".ant-form-vertical &":{marginInlineStart:"4px"}},[`.${g.labelMain}`]:{gridArea:g.labelMain},[`.${g.optionalMark}`]:{gridArea:g.optionalMark},"&:after":{gridArea:g.colon},gridTemplateAreas:`"${g.labelMain} ${g.afterLabel} ${g.colon}"`,gridTemplateColumns:"auto 1fr",".ant-form:not(.ant-form-vertical) &":{height:"auto",[`.${g.labelMain}`]:{textAlign:"start"},gridTemplateAreas:[`"${g.labelMain} ${g.colon}"`,`"${g.afterLabel} ${g.afterLabel}"`].join(" "),gridTemplateColumns:"auto"},[`&:has(.${g.optionalMark})`]:{gridTemplateAreas:`"${g.labelMain} ${g.optionalMark} ${g.afterLabel} ${g.colon}"`,gridTemplateColumns:"auto auto 1fr",".ant-form:not(.ant-form-vertical) &":{gridTemplateAreas:[`"${g.labelMain} ${g.optionalMark} ${g.colon}"`,`"${g.afterLabel} ${g.afterLabel} ${g.afterLabel}"`].join(" "),gridTemplateColumns:"auto auto"}}}}},";label:emotion-item;")}),Se=new WeakMap;function Cr(){function e(i){const c=Se.get(i);if(!c)throw new Error("EasyForm not found.");return c}function t(){const[i]=b.useForm(),[c]=d.useState(function(){const y=X(i),h=G()(()=>({initialValues:void 0,values:void 0,fields:[]}),Q);function E(){return h(({fields:v})=>v.some(F=>F.touched))}function w(){return h(({fields:v})=>v.some(F=>F.validating))}function x(){return h(({fields:v})=>v.some(F=>F.validated))}function C(){return h(({fields:v})=>v.some(F=>F.errors&&F.errors.length>0))}function K(){return h(({values:v,initialValues:F})=>!B(v,F))}const Y={useTouched:E,useValidating:w,useValidated:x,useInvalid:C,useDirty:K};function V(){const v=y==null?void 0:y.getFields(),F=h.getState().fields;B(F,v)||h.setState({fields:v})}function I(){const v=i.getFieldsValue(),F=h.getState().values;B(F,v)||h.setState({values:v})}function O(){V(),I()}function k(){O(),requestAnimationFrame(O)}const D={...i,resetFields:function(...F){i.resetFields(...F),k()},setFieldValue:function(...F){i.setFieldValue(...F),k()},setFieldsValue:function(...F){i.setFieldsValue(...F),k()},setFields:function(...F){i.setFields(...F),k()}},$={useStore:h,hooks:Y,controller:D,internal:{sync:O,forceSync:k,syncFields:V,syncValues:I}};return Se.set(i,$),$});return d.useMemo(()=>[c,i],[i,c])}function r(){const i=b.useFormInstance();if(!i)throw new Error("The form instance is not initialized.");const c=e(i);if(!c)throw new Error("easyForm is not initialized.");return d.useMemo(()=>[c,i],[c,i])}const s=j(d.forwardRef(function({autoHeightFormItem:c=!1,...u},_){const y=X(u.form),h=e(u.form);if(!h)throw new Error("The form easyForm is not initialized.");const E=h.useStore;Oe(u.initialValues,function(I,O){B(I,O)||(E.setState({initialValues:I}),function(){const Z=(y==null?void 0:y.getFields())??[],ge=ot(Z.flatMap(P=>P.touched?Array.isArray(P.name)?[P.name[0]]:[P.name]:[])),he=Z.flatMap(P=>{if(P.touched)return[];const D=P.name,ye=Array.isArray(D)?D:[D];if(ge.includes(ye[0]))return[];if(!st(I,D))return[];const $=at(I,D);return B($,P.value)?[]:[{...P,value:$}]});u.form.setFields(he)}(),h.internal.forceSync())});const w=M(function(){E.setState({initialValues:u.initialValues,values:u.initialValues,fields:y==null?void 0:y.getFields()})});d.useEffect(function(){w()},[w]);const x=M(function(...I){var k;const O=(k=u.onValuesChange)==null?void 0:k.call(u,...I);return h.internal.forceSync(),O}),C=M(function(...I){var k;const O=(k=u.onFieldsChange)==null?void 0:k.call(u,...I);return h.internal.forceSync(),O}),K=M(function(...I){var k;const O=(k=u.onReset)==null?void 0:k.call(u,...I);return h.internal.forceSync(),O}),Y=u.requiredMark==="optional"?f:u.requiredMark;return l(b,{css:R(c?J.autoHeightFormItem:null,";label:emotion-Form;"),...u,initialValues:u.initialValues,ref:_,onValuesChange:x,onFieldsChange:C,onReset:K,requiredMark:Y})}));H(s,"EasyForm");const a=Object.assign(function({afterLabel:c,...u}){const _=d.useMemo(()=>!Fe(u.label)||!Fe(c),[c,u.label]),y=d.useMemo(()=>_?S(N,{children:[u.label?l("div",{className:g.labelMain,children:u.label}):u.label,c&&l("div",{className:g.afterLabel,onClickCapture:h=>h.stopPropagation(),onClick:h=>h.stopPropagation(),children:c})]}):!u.label,[c,u.label,_]);return u.noStyle?l(b.Item,{...u}):l(b.Item,{...u,name:u.name,..._?{label:y}:{},css:J.item})},{useStatus:b.Item.useStatus});H(a,"EasyFormItem");const n=function({children:c,...u}){const _=d.useCallback(function(...h){return c(b.Item,...h)},[c]);return l(b.List,{...u,name:u.name,children:_})};H(n,"EasyFormList");function o(i,c){return b.useWatch(i,c)}const m=({block:i=c=>c.dirty})=>{const[c]=r(),u=c.hooks.useTouched(),_=c.hooks.useValidating(),y=c.hooks.useValidated(),h=c.hooks.useInvalid(),E=c.hooks.useDirty(),w=d.useMemo(()=>({touched:u,validating:_,validated:y,invalid:h,dirty:E}),[u,_,y,h,E]),x=typeof i=="function"?i(w):i;return l(Be.Blocker,{block:x})},p=({render:i})=>{const[c]=r();return i(c)},f=(i,{required:c})=>S(N,{children:[i,c?null:l("span",{css:J.optionalMark,className:g.optionalMark,children:l(Ee,{i18nKey:"component.form.optional"})})]});return Object.assign(s,{Item:a,useForm:t,useFormInstance:r,useWatch:o,List:n,RouterBlocker:m,UseEasyForm:p})}try{BaseNamePath.displayName="BaseNamePath",BaseNamePath.__docgenInfo={description:"Parameters from `Get`.",displayName:"BaseNamePath",props:{}}}catch{}export{A as F,Cr as c,pt as g};
